import{a as ye}from"../chunk-AKIH6YGF.js";import{a as C}from"../chunk-ZZTYZOVH.js";import{a as x}from"../chunk-JNRIG2NX.js";import{a as P}from"../chunk-FE2D6PWX.js";import{a as O}from"../chunk-HUQAMCEL.js";import{a as b}from"../chunk-MA6NDXJH.js";import{a as p}from"../chunk-NGPHGB55.js";import"../chunk-HXT67TO7.js";import{d as g,h as S}from"../chunk-56DI6H62.js";import{a as u}from"../chunk-XG4FNACR.js";import{b as f}from"../chunk-3PCOBUZ4.js";import{a as d,b as c,c as be,e as U,f as ve,g as z,h as T,j as E}from"../chunk-MRANB4J3.js";import"../chunk-EDKSZH7L.js";function we(){let r=!1,e=document.createElement("div");return e.className="advertorial adv ad co-container ad-contain",e.setAttribute("style","width:300px;height:250px;position:absolute;top:-1000px;left:-1000px"),document.body.appendChild(e),r=(e.clientHeight||e.offsetHeight)<=0,r}function $(r){return r.endsWith("/")?r.slice(0,-1):r}function N(r,e,t=""){let i=[],o=(e||t).split("#");return o.length>1&&(i=o[1].split(r)),i}function ke(r,e){let t={},i,n;return r.forEach(o=>{i=o.replace(e,"").split("=")[0],n=o.replace(e,"").split("=")[1],t[i]=n}),t}function Te(){try{return window.history.replaceState?window.history.replaceState(null,document.title,window.location.pathname+window.location.search):window.location.hash="",window.location.href}catch{return window.location.href}}var J=class{constructor(){this.completionRate=0;this.dataAlreadySent=!1;this.feedbackCount=0;this.socialShareCount=0;this.piCount=0;this.startTime=Date.now(),this.pixelId=""}init(){if(window.ui.recom)this.recoUrl=window.ui.recom.endpoint,this.contentType=window.ui.recom.contentType,this.contentType==="Video"&&(this.completionRate=-1);else return;this.attachRecoListeners(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&this.sendTrackingData()})}attachRecoListeners(){c.subscribe("content:recoCCR",e=>{let t=e,i=t.progress*100||0,n=t.contentType??"";this.contentType===n&&i>=this.completionRate&&(this.completionRate=i)}),c.subscribe("globalReco:userFeedback",e=>{this.increaseTrackingCounter(e)}),c.subscribeOnce("analyticsReco:clicksReady",e=>{if(this.recoUrl){let t=this.recoUrl.includes("?"),i=e&&Array.isArray(e)?(t?"&":"?")+"module="+decodeURIComponent(e.join(".")):"";this.fireRecoTracking(this.recoUrl+i)}}),c.subscribe("analyticsReco:clickOut",e=>{let{recoUrl:t,clicks:i}=e;if(t){let n=t.includes("?"),o=i?(n?"&":"?")+"module="+decodeURIComponent(i):"";this.fireRecoTracking(t+o)}})}increaseTrackingCounter(e){switch(e){case"feedbackCount":this.feedbackCount++;break;case"socialShareCount":this.socialShareCount++;break;case"piCount":this.piCount++;break}}async fireRecoTracking(e){await U.putJSON(e,{}).then(t=>{let i=t.pixelId;i&&(this.pixelId=i)})}limitNumberWithinRange(e,t=1,i=100){let n=Math.round(e);return Math.min(Math.max(n,t),i)}getTrackingData(){let e=Date.now(),t=Math.floor((e-this.startTime)/1e3),i={pixelId:this.pixelId,timeOnPage:t.toString()};return(this.contentType==="Article"||this.contentType==="Video"||this.contentType==="Slideshow")&&this.completionRate>-1&&(this.completionRate=this.limitNumberWithinRange(this.completionRate,0,100),i.completionRate=this.completionRate.toString()),this.feedbackCount>0&&(i.feedbackCount=this.limitNumberWithinRange(this.feedbackCount).toString()),this.socialShareCount>0&&(i.socialShareCount=this.limitNumberWithinRange(this.socialShareCount).toString()),this.piCount>1&&(i.piCount=this.limitNumberWithinRange(this.piCount,2,1e3).toString()),i}sendTrackingData(){if(!(this.dataAlreadySent||this.pixelId==="")&&this.recoUrl)try{let e=new URL(this.recoUrl);for(let[t,i]of Object.entries(this.getTrackingData()))e.searchParams.set(t,i);this.fireTrackingRequest(e.href),window.ui.recom.urlsend=e.href,this.dataAlreadySent=!0}catch(e){d.logUnknownError(e,"RecoTracking")}}fireTrackingRequest(e){navigator.sendBeacon(e)}},G=new J;var Z=class{constructor(){this.name_="analytics",this.dom_=T,this.logger_=d,this.pubsub_=c,this.currentLocation_={href:"",msctObj:!1,brainObj:!1,untreatedBrainZone:!1,layoutClass:void 0,deviceClass:void 0,deviceClient:void 0,ff:void 0},this.videoAutoplay_=void 0,this.isEvent_=!1,this.hashActive_=!1,this.adblockerDetected_=!1,this.iframeTrackingStarted_=!1,this.bypassFirstPixelPatterns_=["wahlomat-"],this.bypassFirstPixelReqs_=[],this.tcfLayerShown_=!1,this.permissionGranted_=!1,this.paramsNeedConsent_=[],this.alreadyGotDeviceClass_=!1}set currentLocationHref(e){this.currentLocation_.href=e}init(e={},t=!1){this.currentLocation_.href=e.href||window.location.href,this.currentLocation_.deviceClient=window.ui&&window.ui.pageinfo?window.ui.pageinfo.deviceclient:"browser";try{window.sessionStorage.getItem("_rfcp_")&&(this.tcfLayerShown_=!0)}catch(i){d.logUnknownError(i,"analytics")}this.permissionGranted_=t,this.paramsNeedConsent_=["hid","loginstate","lvts","sample","screenres","screenresolution","segment","session","var","viewportheight","viewportwidth","viewres"],G.init(),this.adblockerDetected_=we(),u.updateUtagData(this.adblockerDetected_),this.readTraceTracking(),this.attachAnalyticsListeners(),this.addPartnerTrackingPixel(),window.potec||(window.potec={}),typeof window.potec.countWAPI!="function"&&(window.potec.countWAPI=this.countWAPI),c.subscribe("multisearch:pingAnalyticsReady",()=>{c.publish("analytics:ServiceReady")}),c.publish("analytics:ServiceReady")}readTraceTracking(){let e;try{z.getItem("trace")&&z.removeItem("trace");let i=localStorage.getItem("trace");i&&(i=JSON.parse(i),i.location===$(this.currentLocation_.href)&&(e=i.brainZone.split("."),this.currentLocation_.brainObj=e,this.currentLocation_.untreatedBrainZone=i.brainZone,localStorage.removeItem("trace")))}catch(t){this.log(t.toString())}}attachAnalyticsListeners(){this.subscribe("tracker:sendEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("staticnext:sendPIPixel",e=>{this.controlTracking(e,!1)}),this.subscribe("starpreview:openOrCloseEvent",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("starpreview:textlink1",e=>{this.setTraceTracking(e.targetUrl,e.brainData)}),this.subscribe("analytics:trackVideoEvent",e=>{this.log(`Video: ${e}`)}),this.subscribe("video-slider:setEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("video-slideshow:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("video-slideshow:setEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("video-slider:brain-tracking",e=>{this.controlTracking(e,!1)}),this.subscribe("quiz:setPixel",e=>{this.controlTracking(e,!1),u.callTealiumView({newContentType:"quiz.detail"})}),this.subscribe("slideshow:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1),u.callTealiumView({newContentType:"slideshow.detail"})}),this.subscribe("slideshow:setAdPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1),u.callTealiumView({newContentType:"slideshow.ad"})}),this.subscribe("slideshow:arrowClicked",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("votingtool:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1),u.callTealiumView()}),this.subscribe("video:setPixel",e=>{e.autoPlay&&(this.videoAutoplay_=e.autoplay,delete e.autoplay),this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("magnifier:setPixel",e=>{this.controlTracking(e,!1),u.callTealiumView({newContentType:"article.fullscreen-image"})}),this.subscribe("region:open-select",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("figcaption:setPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1),u.callTealiumView()}),this.subscribe("social:share",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("header:multisearch",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("createHeaderBiddingPixel",e=>{new Image().src=e}),this.subscribe("content:feedback",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:articleReadProgress",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:infinitescrollScrolling",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:voting",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("article:rating",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("general:newContent",e=>{this.appendBrainZone(e)}),this.subscribe("navigation:ready",e=>{this.appendBrainZone(e)}),this.subscribe("slideshow:ready",e=>{this.appendBrainZone(e)}),this.subscribe("region:optionClick",e=>{this.setTraceTracking(e.targetUrl,e.brainData)}),this.subscribe("horoscope:brainzone",e=>{let t=e.getElementsByTagName("a")[0],i=t.getAttribute("data-brain-zone");this.setTraceTracking(t.href,i),location.href=t.href}),this.subscribe("track:dialogShow",e=>{this.controlTracking(e,!1),u.callTealiumView()}),this.subscribe("track:welcomebackDialogShow",e=>{this.controlTracking(e,!1),u.callTealiumView({newContentName:"welcome-layer",newPageType:"layer",newAgof:"735"})}),this.subscribe("track:dialogCloseNormalPi",e=>{this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("track:emojifeedback",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("feedback:form",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("welcomeback:brainzone",e=>{this.appendBrainZone(e)}),this.subscribe("relatedvideo:setclick",e=>{this.setTraceTracking(e.destination,e.brainData)}),this.subscribe("navigation:brainZone",e=>{console.log("click from navi ",e),this.setTraceTracking(e.destination,e.brainData)}),this.subscribe("ad:gotDeviceClass",e=>{if(!(Object.keys(e).length<1)&&!this.alreadyGotDeviceClass_){if(this.currentLocation_.ff=e.ff,this.currentLocation_.layoutClass=e.layoutclass,this.currentLocation_.deviceClass=e.deviceclass,this.appendBrainZone(),document.querySelector('[data-mod-name="inboxnews"]'))this.controlTracking({clickname:"open",referrer:"undef",contentmode:O.isActivated()?"darkmode-on":"darkmode-off"},!1);else if(document.querySelector('[data-mod-name="imagegallery"]')){let t=document.querySelector('[data-mod-name="imagegallery"]').dataset.slideTotal;this.controlTracking({clickname:"slideshow_right",slidenumber:"0/"+t,contentmode:O.isActivated()?"darkmode-on":"darkmode-off"},!1)}else this.controlTracking({contentmode:O.isActivated()?"darkmode-on":"darkmode-off"},!0),this.clickOuts(),this.trackTeaserImpressions(),this.optOutTransfer();this.alreadyGotDeviceClass_=!0}}),this.subscribe("inboxnews:optOut",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("externalembed:optin",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("topnav",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("appbanner:event",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.attachWhitelabelListener()}addPartnerTrackingPixel(){try{window.ui.partnerTrackingPixel&&window.ui.partnerTrackingPixel.forEach(t=>{new Image().src=t})}catch(e){this.log(e)}}controlTracking(e,t){e||(e={});let i=this.getControllVars();if(i.fireBrain){if(this.checkBypassFirstPixel(e.clickname))return;this.buildAndFireBrainUrl(e,t)}i.retVal&&this.initMsct(i.retVal,i.removeStr,e)}getControllVars(){let e="",t="",i=this.currentLocation_.href.indexOf("#"),n=this.currentLocation_.href.slice(i,i+5),o=!0;if(i!==-1||window.homepagehash)if(this.hashActive_=!0,n==="#msct")e="msct",t="msct_";else{let s=this.currentLocation_.href.slice(i,this.currentLocation_.href.length),a=s.indexOf("#.");window.homepagehash&&(this.log('Got "window.homepagehash" for tv program. Overwriting variables.'),s=window.homepagehash,a=0,delete window.homepagehash,this.hashActive_=!0),a===0&&(e=N(".",s,this.currentLocation_.href)[2]==="inbox"?"inbox":"homepage",o=!1,t=s)}return{retVal:e,fireBrain:o,removeStr:t}}buildAndFireBrainUrl(e,t){if(!window.ui.brain)return;let i=window.ui.brain.piUrl;this.isEvent_&&(i=window.ui.brain.eventUrl,this.isEvent_=!1);let n={piUrl:i,screenres:window.screen.width+"x"+window.screen.height,viewres:document.documentElement.clientWidth+"x"+document.documentElement.clientHeight,layoutclass:this.currentLocation_.layoutClass,deviceclass:this.currentLocation_.deviceClass,deviceclient:this.currentLocation_.deviceClient,click1:this.currentLocation_.brainObj[1],click2:this.currentLocation_.brainObj[2],click3:this.currentLocation_.brainObj[3],click4:this.currentLocation_.brainObj[4],clickname:e.clickname||"undefined",pageVisibility:document.visibilityState,ts:Date.now(),random:parseInt((Math.random()*1e5).toString(),10),adblock:this.adblockerDetected_?"1":"0",title:encodeURIComponent(document.title),tcflayer:this.tcfLayerShown_?1:0};i.includes("type=")||(n.type="view");let o=sessionStorage.getItem("originalReferrer");o?sessionStorage.removeItem("originalReferrer"):o=document.referrer;let s={pageurl:encodeURIComponent(this.currentLocation_.href),referrer:encodeURIComponent(o)},a=this.buildTrackingUrl(n,s,e,t);if(!this.isEvent_)try{let l=new URL(a);new URLSearchParams(l.search).get("name").includes(".pi.")&&G.increaseTrackingCounter("piCount")}catch(l){d.logUnknownError(l,"analyticsReco")}this.pubsub_.publish("analyticsReco:clicksReady",this.currentLocation_.brainObj),e.videoaction?window.navigator.sendBeacon(a):document.createElement("img").src=a,Array.isArray(window.ui.brain.pisend)?window.ui.brain.pisend.indexOf(a)<0&&window.ui.brain.pisend.push(a):window.ui.brain.pisend=[a]}buildTrackingUrl(e,t,i,n){let o="";e.type&&i.piUrl&&i.piUrl.includes("type=")&&(delete i.type,delete e.type);let s=Object.assign(e,i),a=Object.assign(t,i);s=Object.assign(s,a),o=s.piUrl,delete s.piUrl,s=this.onlyPermittedParams(s);for(let l in s)if(C.hasProperty(s,l)){let h=String(s[l]).replace(`&${l}=`,"");o+=`&${l}=${h}`}return this.generateDerefererLink(e,t,n),o}generateDerefererLink(e,t,i){let n="";if(!i)return;let o=Object.assign(e,t);if(window.ui.brain){let s=this.currentLocation_.brainObj;o.piUrl="",[1,2,3,4].forEach(a=>{o["click"+a.toString()]=s[a]&&s[a]!==""?`&click${a}=${s[a]}`:""}),delete o.type,o=this.onlyPermittedParams(o);for(let a in o)C.hasProperty(o,a)&&(n+=`&${a}=${o[a]}`);window.ui.brain.dereferer=n}}onlyPermittedParams(e){return this.permissionGranted_||this.paramsNeedConsent_.forEach(t=>{delete e[t]}),e}initMsct(e,t,i){let n=this.getMsctControlVars(e,t);try{n.fireBrain!==!1&&(this.currentLocation_.brainObj=n.fireBrain,this.buildAndFireBrainUrl(i,!1)),n.removeHash&&this.hashActive_&&(this.hashActive_=!1,this.currentLocation_.href=Te())}catch(o){this.log(o)}}getMsctControlVars(e,t){let i=!1,n=!1,o=!1,s=a=>(C.hasProperty(a,"mtype")||(a.mtype="wsite"),a.pageid=0,a);switch(e){case"msct":{let a=ke(N(";",void 0,this.currentLocation_.href),t);n=s(a),i=!0;break}case"homepage":case"inbox":{o=N(".",t),i=!0;break}case"advertorial":n=s({});break}return{fireConversion:n,fireBrain:o,removeHash:i}}readTriggerTracking(e){let t;try{this.currentLocation_.brainObj=!1,window.ui.brain&&window.ui.brain.trigger&&(this.log("brain.trigger: "+window.ui.brain.trigger),t=window.ui.brain.trigger.split("."),this.currentLocation_.brainObj=t,delete window.ui.brain.trigger,[1,2,3,4].forEach(i=>{delete e[`click${i.toString()}`]}),this.log("readTriggerTracking: "+JSON.stringify(e)))}catch(i){this.log(i)}return e}appendBrainZone(e){let i=(e||document).querySelectorAll("a[data-brain-zone]"),n=e?e.classList.contains("innernav"):!1,o=s=>{s.addEventListener("click",async a=>{let l=a.currentTarget,h=l.getAttribute("data-brain-zone"),m=l.getAttribute("href");await window.yieldToMain(),this.setTraceTracking(m,h)}),s.setAttribute("data-brained","true")};Array.from(i).forEach(s=>{(n||!s.hasAttribute("data-brained")&&!s.hasAttribute("data-co"))&&o(s)})}setTraceTracking(e,t){try{let i=JSON.stringify({location:$(e),brainZone:t});localStorage.setItem("trace",i)}catch(i){this.log(i)}}clickOuts(){let e=document.querySelectorAll("a[data-co]"),t=window.ui.brain?window.ui.brain.dereferer:"";if(!t)return!1;t=t.split("&").filter(n=>!(n.indexOf("click1")>-1||n.indexOf("click2")>-1||n.indexOf("click3")>-1||n.indexOf("click4")>-1)).join("&"),Array.from(e).forEach(n=>{if(n.hasAttribute("data-msctd"))return;n.getAttribute("data-co")==="brain"&&(n.href+=t),n.setAttribute("data-msctd","true")})}trackTeaserImpressions(){if(window.ui.brain){let e=window.ui.brain.teaserImpressions;e&&(e+="&layoutclass="+this.currentLocation_.layoutClass,e+="&deviceclass="+this.currentLocation_.deviceClass,e+="&deviceclient="+this.currentLocation_.deviceClient,e+="&ts="+new Date().getTime().toString(),new Image().src=e)}}attachWhitelabelListener(){window.addEventListener("message",e=>{e.origin==="https://widget.civey.com"&&(e.data.type==="CIVEY_WIDGET_LOADED"||e.data.type==="CIVEY_WIDGET_VOTE")&&window.postMessage({method:"adRefresh",rect:!0},"*")}),window.addEventListener("message",e=>{if(e.data.method==="countWAPI"){let t={referrer:"undefined",click1:"undefined",click2:"undefined",click3:"undefined",click4:"undefined",clickname:"undefined"};e.data.eventname!==!1&&(this.isEvent_=!0),delete e.data.method,delete e.data.eventname,delete e.data.trigger;let i=Object.assign(t,e.data);this.controlTracking(i,!1)}},!1)}countWAPI(e,t){try{let i={method:"countWAPI",clickname:e?e.toString():"undefined",eventname:!!t};window.postMessage(i,"*")}catch(i){this.log(i)}}optOutTransfer(){let e=window.ui.brain;if(e){let t=e.optOutTransferUrl;t&&(new Image().src=t)}}checkBypassFirstPixel(e){let t=!1;return e&&this.bypassFirstPixelPatterns_.forEach(i=>{e.indexOf(i)>=0?this.bypassFirstPixelReqs_.indexOf(e)>=0?t=!1:(this.bypassFirstPixelReqs_.push(e),t=!0):t=!1}),t}log(e){this.logger_.log(this.name_,e)}subscribe(e,t){this.pubsub_.subscribe(e,t)}},Q=new Z;var Y=class{constructor(){this.adServiceBundleUrl="";this.adServiceConnectorUrl="";this.biddingConfigUrls={b:"",m:"",s:""};this.biddingEnabled=!0;this.config={configurations:{prebidVideoTimeout:{s:0,m:0,b:0},visibilityLookahead:0},exclusionRules:{},prebidRules:{}};this.exclusionRules={};this.prebidRules={};this.enabled=!0;this.init={};this.nonFriendlyIFrameDocument="";this.pageCategory="";this.configurations={}}},K=class{},X=class{constructor(){this.adBiddingConfigFileUrl_="";this.adServiceConfig_=new Y;this.adComponentsLoaded_=new K;this.pubSub_=c;this.logger_=d;this.adServiceLoadedWithDefaultConfig=!1}set adBiddingConfigFileUrl(e){this.adBiddingConfigFileUrl_=e}set adServiceConfig(e){this.adServiceConfig_=e}get externalConfig(){return this.externalConfig_}checkRequireJs(){typeof window.requireJS=="object"&&typeof window.requireJS.define=="function"||this.mockRequireJs()}mockRequireJs(){window.requireJS={define:e=>{this.externalConfig_=e},require:()=>{}}}run(){if(!p.get("adServiceEnabled")){this.sendFallbackTrackingInfo();return}this.checkRequireJs(),window.ui.noCORSUrls=window.ui.noCORSUrls||[],window.ui.noCORSUrls.push(this.adBiddingConfigFileUrl_),this.perf_=window.performance??{mark:()=>{}},this.loadAdServiceBundle(()=>{this.setAdComponentLoaded("bundle")}),this.loadAdServiceConfig(e=>{this.applyExternalConfig(e)},()=>{this.useDefaultConfig()})}adBiddingEnabled(){return this.adServiceConfig_.biddingEnabled||!1}sendFallbackTrackingInfo(){let e="s",t=document.documentElement.clientWidth;document.documentElement.classList.add("ab-active"),t>=768&&t<1024?e="m":t>=1024&&(e="b"),this.pubSub_.publish("ad:gotDeviceClass",{layoutclass:e,deviceclass:"undef",ff:"unknown"})}startAdService(){typeof window.AdService>"u"?this.sendFallbackTrackingInfo():(this.perf_.mark("adservice-init-start"),this.pubSub_.publish("asLoader:AdServiceLoaded",{useDefaultConfig:this.adServiceLoadedWithDefaultConfig}))}setAdComponentLoaded(e){this.adComponentsLoaded_[e]=!0,this.adComponentsLoaded_.bundle&&this.adComponentsLoaded_.config&&(window.ui.AdServiceConfig=Object.assign(window.ui.AdServiceConfig,this.adServiceConfig_),this.startAdService())}useDefaultConfig(){this.adServiceLoadedWithDefaultConfig=!0,this.adServiceConfig_.config={exclusionRules:{},prebidRules:this.adServiceConfig_.prebidRules,configurations:{}},this.setAdComponentLoaded("config")}loadAdServiceConfig(e,t){this.adBiddingEnabled()?this.adBiddingConfigFileUrl_&&P.fetch(this.adBiddingConfigFileUrl_,!1,!1).then(()=>{e(this.externalConfig_)}).catch(()=>{t()}):this.useDefaultConfig()}loadAdServiceBundle(e){let t=window.ui.AdServiceAlternativeUrl||window.ui?.AdServiceConfig?.adServiceBundleUrl;t?(this.perf_.mark("adservice-load-start"),P.fetch(t,void 0,!1).then(()=>{this.perf_.mark("adservice-load-end"),this.setAdComponentLoaded("bundle")}).catch(()=>{typeof e=="function"&&e()})):this.logger_.log("Adservice","Cant load adservice bundle provide adservice url")}applyExternalConfig(e){this.adServiceConfig_.config={exclusionRules:e.exclusionRules,prebidRules:e.prebidRules,configurations:e.configurations||{}},this.setAdComponentLoaded("config")}},D=new X;var Ye=(r,e,t)=>g`
  <div class="imageFullScreen">
    <a href="#" class="closeOverlay">
      <span class="icon icon-close"></span>
    </a>
    <figure class="imgContainer bgimg" style="background-image: url('${t}');">
      <figcaption class="figcaption">
        <span class="icon-subtext icon"></span>
        <div class="caption">
          <span class="description">
            <span class="copyright">
              ${r}
            </span>
            ${e}
          </span>
        </div>
      </figcaption>
    </figure>
  </div>`,ee=class{constructor(){this.lineHeight=25}init(){try{c.subscribe("overlay:showBiggerImage",e=>{let t=e,i=t.copyright,n=t.description,o=t.pictureContent,s=T.fromHtml(""),a=t.trackingData;S(Ye(i,n,o),s),document.getElementsByClassName("ocw")[0].appendChild(s);let h=document.querySelector("a.closeOverlay"),m=t.overlayInfo.overlayElem;h&&m&&h.addEventListener("click",A=>{A.preventDefault(),m.parentNode?.removeChild(m),this.sendCloseEvent(a)}),document.addEventListener("keyup",A=>{A.key==="Escape"&&(m.parentNode?.removeChild(m),this.sendCloseEvent(a))}),this.sendOpenEvent(a);let k=document.querySelector(".imageFullScreen")?.querySelector("figcaption");k&&(this.configureCaptionStyling(k,!1),k.classList.contains("is-extendable")&&k.addEventListener("click",function(A){A.stopPropagation(),k.classList.contains("opened")?k.classList.remove("opened"):k.classList.add("opened");let R=k.querySelector(".caption");try{R&&(k.classList.contains("opened")?(localStorage.setItem("descriptionState","opened"),R.style.height=R.dataset.height+"px"):(localStorage.setItem("descriptionState","false"),R.style.height=""))}catch(Ze){d.logUnknownError(Ze,"Magnifier")}}))})}catch(e){d.logUnknownError(e,"[magnifier]"),c.publish("sentry:log",{error:e})}}configureCaptionStyling(e,t){let i=e.getElementsByClassName("description")[0],n=e.getElementsByClassName("caption")[0],o=0;i.style.whiteSpace="normal",o=i.offsetHeight,i.style.whiteSpace="",t==="opened"?(e.classList.add("opened"),window.setTimeout(()=>{n.style.height=o+"px"},500)):e.classList.remove("opened");let s=e.getElementsByClassName("copyright")[0];s.textContent&&s.textContent.length-2===0&&(s.style.display="none"),(i.offsetWidth<i.scrollWidth||i.offsetHeight>this.lineHeight*1.5)&&e.classList.add("is-extendable"),n.dataset.height=o.toString()}sendOpenEvent(e){let{componentName:t,componentPath:i}=e;if(c.publish("magnifier:setPixel",{referrer:"&referrer=undefined",click1:"&click1="+window.ui.pageinfo.coremid,click2:"&click2=magnifier",click3:"&click3=open",click4:"&click4=1",clickname:"&clickname=magnifier_open"}),i){let n={businessEventType:"userAction",componentResultState:"enlarged",componentPath:i,elementTagName:"a",eventType:"mousedown"};t&&(n.componentName=t),u.callTealiumLink(n)}}sendCloseEvent(e){let{componentName:t,componentPath:i}=e;if(c.publish("overlayDestroyed",{resetAdConfig:!1,moduleName:"magnifier",optTrackingName:"_close"}),i){let n={businessEventType:"userAction",componentPath:i,componentResultState:"minimized",elementTagName:"span",eventType:"mousedown"};t&&(n.componentName=t),u.callTealiumLink(n)}}},Ce=new ee;var Ke=g`
<div class="siteOverlay">
  <div class="overlayWrapper">
    <div class="tr">
      <div class="overlayContent tc">
        <div class="ocw"></div>
      </div>
      <div class="tc sky-overlay-wrapper">
        <div class="co-container ad-overlay-sky js-co-dynamic" data-service-param-tagid="sky_on_overlay"></div>
      </div>
    </div>
  </div>
</div>`,Xe=(r,e)=>g`
<div class="dialogOverlay" data-type="${e}">
  <div class="dialogWrapper bouncein">
    <div class="close-bar">
      <span class="icon icon-close js-close"></span>
    </div>
    <div class="dialogContent">${x(r)}</div>
  </div>
</div>`,te=class{constructor(){this.selectors={layerContent:".overlayContent",layerContentWrapper:".overlayContent .ocw",dialogWrapper:".dialogWrapper",dialogContent:".dialogContent"},this.isDialog=!1,this.avoidVerticalStylingCss=null,this.lastScrollPosition=0,this.overlayElement=null}log(e,t){console.log("[overlay]",e,t)}publish(e,t={}){c.publish(e,t)}subscribe(e,t){c.subscribe(e,t)}init(){this.log("init");try{this.subscribe("article:magnifier",e=>{this.log("Magnifier triggered from article",e),e.overlayInfo=this.createOverlay(),this.publish("overlay:showBiggerImage",e)}),this.subscribe("overlayDestroyed",e=>{e=e||"",this.log("overlayDestroyed",e);try{this.overlayElement=null,f.showScrollbar(),(this.avoidVerticalStylingCss!==null||typeof this.avoidVerticalStylingCss<"u")&&(this.avoidVerticalStylingCss.innerHTML="",window.scrollTo(0,this.lastScrollPosition)),this.publish("ad:refreshAll"),this.fireTrackingPixel(e),this.publish("welcomeback:restartWBTimer")}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}),this.subscribe("overlay:showWelcomeback",e=>{this.createWelcomebackDialog(e.content,e.module,e.opts,e.callback),this.setDialogSize(e.module)}),this.subscribe("overlay:close",e=>{this.closeDialog(e)}),this.subscribe("window:resize",()=>{this.isDialog&&this.overlayElement&&this.setDialogSize()})}catch(e){this.log(e),this.publish("sentry:log",{error:e})}}createWelcomebackDialog(e,t,i,n){if(n=n||function(){},i=i||{},this.overlayElement){this.log("An overlay already exists.");return}let o=T.fromHtml("");S(Xe(e,t),o),this.overlayElement=o.firstElementChild,this.overlayElement.setAttribute("data-open","true"),document.body.appendChild(o),this.overlayElement=this.overlayElement||document.querySelector(".dialogOverlay"),this.log("this.overlayElement",this.overlayElement),this.isDialog=!0,f.hideScrollbar();let s=i.wbTrackingVar?i.wbTrackingVar:"";this.publish("track:welcomebackDialogShow",{referrer:"&referrer=undefined",click1:"&click1="+p.get("pageinfo").coremid,click2:"&click2="+t,click3:"&click3=open"+s,click4:"&click4=1",clickname:"&clickname="+t+"_open"}),this.overlayElement.style.height=window.innerHeight+"px",window.setTimeout(()=>{this.overlayElement.classList.add("fadeIn")},100);let a=this.overlayElement.getElementsByClassName("dialogContent")[0];n(a),this.publish("video:pauseAllPlayers"),this.publish("welcomeback:stopWBTimer"),this.overlayElement.getElementsByClassName("js-close")[0].addEventListener("click",l=>{l.preventDefault(),this.closeDialog(t)}),document.addEventListener("keyup",l=>{l.key==="Escape"&&this.closeDialog(t)})}closeDialog(e){this.log("closeDialog()",e);try{this.isDialog=!1,this.overlayElement.setAttribute("data-open","false"),this.publish("ad:refreshAll"),this.fireTrackingPixel(e),e==="welcomelayer"&&u.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.close-bar.icon-close",componentResultState:"close",elementTagName:"div",eventType:"mousedown"}),this.publish("welcomeback:restartWBTimer"),this.overlayElement.classList.remove("fadeIn");let t=document.querySelector(this.selectors.dialogWrapper);t.classList.remove("bouncein"),e==="feedback_success"?t.classList.add("closed"):t.classList.add("bounceout"),setTimeout(()=>{this.removeDialog()},1e3)}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}removeDialog(){this.overlayElement.remove(),this.overlayElement=null,f.showScrollbar()}setDialogSize(e){e=e||this.overlayElement.dataset.type;try{let t=document.getElementsByClassName("content")[0];if(t){let i=t.getBoundingClientRect().width-32;i>900&&(i=900),e==="welcomelayer"&&(i=Math.min(document.documentElement.clientWidth-32,1144));let n=this.overlayElement.getElementsByClassName("close-bar")[0],o=this.overlayElement.getElementsByClassName("dialogContent")[0],s=window.innerHeight+"px",a=i+"px";n.style.width=a,o.style.width=a,o.style.maxHeight=s,this.overlayElement.style.height=s}}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}createOverlay(){try{if(this.log("createOverlay()"),this.overlayElement){this.log("An overlay already exists.");return}this.lastScrollPosition=window.scrollY;let e=T.fromHtml("");S(Ke,e),this.overlayElement=e.firstElementChild,document.body.appendChild(e);let t=document.getElementById("avoidVerticalScroll"),i="html, body {margin: 0; height: 100%; overflow: hidden}";t?t.innerHTML=i:(this.avoidVerticalStylingCss=document.createElement("style"),this.avoidVerticalStylingCss.id="avoidVerticalScroll",this.avoidVerticalStylingCss.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(this.avoidVerticalStylingCss)),this.overlayElement=this.overlayElement||document.querySelector(".siteOverlay");let n={overlayElem:this.overlayElement,overlayContentSelector:this.selectors.layerContent,overlayContentWrapperSelector:this.selectors.layerContentWrapper};return f.hideScrollbar(),this.refreshAds(),this.log("overlay created"),n}catch(e){console.error(e),this.publish("sentry:log",{error:e})}}refreshAds(){try{if(this.log("refreshAds()"),f.matches("tablet")){let e=[],t=document.querySelectorAll(".js-co-dynamic");this.log("dynamicAds",t),t.forEach(i=>{this.log("refreshAds: got ad container ",i),!(!f.matches("desktop")&&i.classList.contains("ad-overlay-sky"))&&(this.log("refreshAds: pushing ad container",i),e.push(i))}),this.publish("dynamicAdsNeeded",e)}}catch(e){this.log(e),this.publish("sentry:log",{error:e})}}fireTrackingPixel(e){try{let t="",i="";if(typeof e=="object"?(e.resetAdConfig===!0&&this.publish("ad:resetAdConfig"),i=e.moduleName,t=i+(e.optTrackingName?e.optTrackingName:"_close")):(i=e,t=e+"_close"),p.get("brain")){let n=e.coremId?e.coremId:p.get("pageinfo").coremid;window.ui.brain.trigger="."+n+"."+i+".close.1"}this.publish("track:dialogCloseNormalPi",{referrer:"&referrer=undefined",click1:"&click1=undefined",click2:"&click2=undefined",click3:"&click3=undefined",click4:"&click4=undefined",clickname:"&clickname="+t})}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}},Se=new te;var ie=class{constructor(){this.loadedServices=new Map,d.log("ServiceFactory","initialization completed")}async getService(e){let t=this.loadedServices.get(e);if(t)return t;{let i=await import(`${b.sn}/${e}`);if(i)return this.loadedServices.set(e,i.default),i.default;throw new Error("Unable to load the service: "+e)}}},ne=new ie;var re=class{init(){try{this.setToolsClassSize(),c.subscribe("layoutChanged",()=>{this.setToolsClassSize()}),c.subscribe("window:resize",()=>{this.setToolsClassSize()}),c.subscribe("masonrized",()=>{this.setToolsClassSize()})}catch(e){c.publish("sentry:log",{error:e})}}setToolsClassSize(){try{document.querySelectorAll(".mod-tool").forEach(t=>{t.offsetWidth<350?(t.classList.add("tiny"),t.offsetWidth<320?t.classList.add("xs"):t.classList.remove("xs"),t.classList.remove("maxi"),this.modifySuggestion(t,"tiny")):t.offsetWidth>670?(t.classList.add("maxi"),t.classList.remove("tiny"),t.classList.remove("xs"),this.modifySuggestion(t,"maxi")):(t.classList.remove("maxi"),t.classList.remove("tiny"),t.classList.remove("xs"),this.modifySuggestion(t,"maxi"))})}catch(e){c.publish("sentry:log",{error:e})}}modifySuggestion(e,t){let i=e.querySelectorAll(".suggestion");switch(t){case"tiny":i.forEach(n=>{n.classList.remove("maxi"),n.classList.add("tiny")});break;case"maxi":i.forEach(n=>{n.classList.remove("tiny"),n.classList.add("maxi")});break;default:break}}},Ee=new re;function se(r,e){r=r||document,r.querySelectorAll("[data-wc-name]").forEach(i=>{let n=i.tagName,o=i.getAttribute("data-wc-name");if(customElements.get(n)===void 0&&o){let s=`${e}/mod-${o}/${o}.js`;try{import(s)}catch(a){console.error("Dynamic loading error: ",a)}}})}var ce;var Be=-1,L=function(r){addEventListener("pageshow",function(e){e.persisted&&(Be=e.timeStamp,r(e))},!0)},le=function(){var r=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(r&&r.responseStart>0&&r.responseStart<performance.now())return r},H=function(){var r=le();return r&&r.activationStart||0},y=function(r,e){var t=le(),i="navigate";return Be>=0?i="back-forward-cache":t&&(document.prerendering||H()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:r,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},I=function(r,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(r)){var i=new PerformanceObserver(function(n){Promise.resolve().then(function(){e(n.getEntries())})});return i.observe(Object.assign({type:r,buffered:!0},t||{})),i}}catch{}},w=function(r,e,t,i){var n,o;return function(s){e.value>=0&&(s||i)&&((o=e.value-(n||0))||n===void 0)&&(n=e.value,e.delta=o,e.rating=function(a,l){return a>l[1]?"poor":a>l[0]?"needs-improvement":"good"}(e.value,t),r(e))}},de=function(r){requestAnimationFrame(function(){return requestAnimationFrame(function(){return r()})})},V=function(r){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&r()})},he=function(r){var e=!1;return function(){e||(r(),e=!0)}},_=-1,_e=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},F=function(r){document.visibilityState==="hidden"&&_>-1&&(_=r.type==="visibilitychange"?r.timeStamp:0,et())},Le=function(){addEventListener("visibilitychange",F,!0),addEventListener("prerenderingchange",F,!0)},et=function(){removeEventListener("visibilitychange",F,!0),removeEventListener("prerenderingchange",F,!0)},Re=function(){return _<0&&(_=_e(),Le(),L(function(){setTimeout(function(){_=_e(),Le()},0)})),{get firstHiddenTime(){return _}}},q=function(r){document.prerendering?addEventListener("prerenderingchange",function(){return r()},!0):r()},Ae=[1800,3e3],tt=function(r,e){e=e||{},q(function(){var t,i=Re(),n=y("FCP"),o=I("paint",function(s){s.forEach(function(a){a.name==="first-contentful-paint"&&(o.disconnect(),a.startTime<i.firstHiddenTime&&(n.value=Math.max(a.startTime-H(),0),n.entries.push(a),t(!0)))})});o&&(t=w(r,n,Ae,e.reportAllChanges),L(function(s){n=y("FCP"),t=w(r,n,Ae,e.reportAllChanges),de(function(){n.value=performance.now()-s.timeStamp,t(!0)})}))})},Pe=[.1,.25],Ue=function(r,e){e=e||{},tt(he(function(){var t,i=y("CLS",0),n=0,o=[],s=function(l){l.forEach(function(h){if(!h.hadRecentInput){var m=o[0],B=o[o.length-1];n&&h.startTime-B.startTime<1e3&&h.startTime-m.startTime<5e3?(n+=h.value,o.push(h)):(n=h.value,o=[h])}}),n>i.value&&(i.value=n,i.entries=o,t())},a=I("layout-shift",s);a&&(t=w(r,i,Pe,e.reportAllChanges),V(function(){s(a.takeRecords()),t(!0)}),L(function(){n=0,i=y("CLS",0),t=w(r,i,Pe,e.reportAllChanges),de(function(){return t()})}),setTimeout(t,0))}))},Oe=0,oe=1/0,M=0,it=function(r){r.forEach(function(e){e.interactionId&&(oe=Math.min(oe,e.interactionId),M=Math.max(M,e.interactionId),Oe=M?(M-oe)/7+1:0)})},Ne=function(){return ce?Oe:performance.interactionCount||0},nt=function(){"interactionCount"in performance||ce||(ce=I("event",it,{type:"event",buffered:!0,durationThreshold:0}))},v=[],W=new Map,Me=0,rt=function(){var r=Math.min(v.length-1,Math.floor((Ne()-Me)/50));return v[r]},st=[],ot=function(r){if(st.forEach(function(n){return n(r)}),r.interactionId||r.entryType==="first-input"){var e=v[v.length-1],t=W.get(r.interactionId);if(t||v.length<10||r.duration>e.latency){if(t)r.duration>t.latency?(t.entries=[r],t.latency=r.duration):r.duration===t.latency&&r.startTime===t.entries[0].startTime&&t.entries.push(r);else{var i={id:r.interactionId,latency:r.duration,entries:[r]};W.set(i.id,i),v.push(i)}v.sort(function(n,o){return o.latency-n.latency}),v.length>10&&v.splice(10).forEach(function(n){return W.delete(n.id)})}}},We=function(r){var e=self.requestIdleCallback||self.setTimeout,t=-1;return r=he(r),document.visibilityState==="hidden"?r():(t=e(r),V(r)),t},xe=[200,500],Fe=function(r,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},q(function(){var t;nt();var i,n=y("INP"),o=function(a){We(function(){a.forEach(ot);var l=rt();l&&l.latency!==n.value&&(n.value=l.latency,n.entries=l.entries,i())})},s=I("event",o,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=w(r,n,xe,e.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),V(function(){o(s.takeRecords()),i(!0)}),L(function(){Me=Ne(),v.length=0,W.clear(),n=y("INP"),i=w(r,n,xe,e.reportAllChanges)}))}))},De=[2500,4e3],ae={},He=function(r,e){e=e||{},q(function(){var t,i=Re(),n=y("LCP"),o=function(l){e.reportAllChanges||(l=l.slice(-1)),l.forEach(function(h){h.startTime<i.firstHiddenTime&&(n.value=Math.max(h.startTime-H(),0),n.entries=[h],t())})},s=I("largest-contentful-paint",o);if(s){t=w(r,n,De,e.reportAllChanges);var a=he(function(){ae[n.id]||(o(s.takeRecords()),s.disconnect(),ae[n.id]=!0,t(!0))});["keydown","click"].forEach(function(l){addEventListener(l,function(){return We(a)},{once:!0,capture:!0})}),V(a),L(function(l){n=y("LCP"),t=w(r,n,De,e.reportAllChanges),de(function(){n.value=performance.now()-l.timeStamp,ae[n.id]=!0,t(!0)})})}})},Ie=[800,1800],at=function r(e){document.prerendering?q(function(){return r(e)}):document.readyState!=="complete"?addEventListener("load",function(){return r(e)},!0):setTimeout(e,0)},Ve=function(r,e){e=e||{};var t=y("TTFB"),i=w(r,t,Ie,e.reportAllChanges);at(function(){var n=le();n&&(t.value=Math.max(n.responseStart-H(),0),t.entries=[n],i(!0),L(function(){t=y("TTFB",0),(i=w(r,t,Ie,e.reportAllChanges))(!0)}))})};var ue=class{constructor(){this.analyticsUrl_="",this.clsEntries=[],this.metricNeeded_=["CLS","LCP","TTFB","INP"],this.metricsSent_=!1,this.alreadyGotDeviceClass_=!1,this.analyticsBody_={}}getAnalyticsUrl(){return window.ui?.webvitals?window.ui.webvitals.endpoint:""}setAnalyticsUrl(e){this.analyticsUrl_=e}initBody(e,t){this.analyticsBody_.deviceclass=e,this.analyticsBody_.layoutclass=t}resetBody(){this.analyticsBody_={},this.clsEntries=[],this.metricsSent_=!1}collectLayoutShift(e){try{window.ui.webvitals?.debugCls&&e.entries.slice(0,10).forEach(t=>{let i=t;i?.sources?.length>0&&this.clsEntries.push(this.convertLayoutShiftEntry(i))})}finally{this.collectMetric(e)}}collectTTFB(e){try{let t=e.entries[0];t&&(this.analyticsBody_.redirectStart=t.redirectStart.toFixed(3),this.analyticsBody_.redirectEnd=t.redirectEnd.toFixed(3),this.analyticsBody_.domainLookupStart=t.domainLookupStart.toFixed(3),this.analyticsBody_.domainLookupEnd=t.domainLookupEnd.toFixed(3),this.analyticsBody_.requestStart=t.requestStart.toFixed(3))}catch(t){console.warn("Unable to add TTFB details",t)}finally{this.collectMetric(e)}}convertLayoutShiftEntry(e){let t=[];return e.sources.slice(0,10).forEach(i=>{t.push(this.convertElementToIdentifier(i.node))}),{value:e.value,sources:t}}convertElementToIdentifier(e){try{if(e){let t=[];for(let i=e;i;i=i.parentNode){if(i.nodeName===null)continue;let n=i.nodeName.toLowerCase();if(n==="html")break;let o=i;o.className&&(n+="."+o.className.replace(/ /g,".")),t.push(n)}return t.reverse(),t.join(" ")}return"no element"}catch(t){return console.error("Unable to create path",t),"error"}}collectMetric(e){console.log("[CWV]",e),this.analyticsBody_[e.name.toLowerCase()]=e.value.toString(),this.metricsSent_||this.allMetricGot()&&(this.sendToAnalytics(),this.metricsSent_=!0)}allMetricGot(){let e=!0,t=Object.keys(this.analyticsBody_);return this.metricNeeded_.forEach(i=>{t.includes(i.toLowerCase())||(e=!1)}),e}objToQueryString(e){let t="";return t=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&"),t}collectElementHeights(){let e=new Map;if(!window.ui?.webvitals)return e;let t=window.ui.webvitals.analyzeElementHeights;return t&&t.forEach(i=>{let n=document.getElementsByClassName(i);if(n&&n.length>0){let o=n[0];o&&e.set(i,o.offsetHeight)}}),e}sendToAnalytics(){let e=this.objToQueryString(this.analyticsBody_),t=this.analyticsUrl_;t.indexOf("?")>0?t+=`&${e}`:t+=`?${e}`;let i={elementHeights:this.collectElementHeights(),clsEntries:this.clsEntries},n=JSON.stringify(i);console.log("[CWV] Details ",n),window.navigator.sendBeacon?typeof Blob<"u"?window.navigator.sendBeacon(t,new Blob([n],{type:"application/json"})):window.navigator.sendBeacon(t):fetch(t,{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:n})}run(){this.analyticsUrl_=this.getAnalyticsUrl(),this.analyticsUrl_?c.subscribe("ad:gotDeviceClass",e=>{let t=e;if(!(Object.keys(t).length<1)&&!this.alreadyGotDeviceClass_){this.initBody(t.deviceclass,t.layoutclass);try{Ue(i=>this.collectLayoutShift(i)),He(i=>this.collectMetric(i)),Ve(i=>this.collectTTFB(i)),Fe(i=>this.collectMetric(i))}catch(i){console.error("Error calling APIs:",i)}this.alreadyGotDeviceClass_=!0}}):console.log("[CWV] Collecting core web vitals disabled.")}},qe=new ue;function ct(r){if(r&&r.length>0)return g`${r.map(e=>g`${x(e.html)}`)}`}function je(r,e,t=!1){return g`<div data-mod-name="welcomeback">
    <div class="wbcontent__top">
      <div class="welcome">
        ${x(r)}<span class="greetings">Das k√∂nnte Sie auch interessieren</span>
      </div>
    </div>

    <div class="wbcontent ${t?"has-taboola":""}">
      <div class="wbcontent__teasers">
        ${t?ht():dt(e)}
      </div>

      <div class="wbcontent__hpad">
        ${t?"":lt()}
      </div>
    </div>

    <!--hide further popups-->
    <a href="#" class="hint js-shownomore">Nicht mehr anzeigen</a>
  </div>`}var lt=()=>g`
  <div class="co-container-container">
    <div class="co-container co-wbhalfpage js-co-dynamic" data-service-param-tagid="rectangle_layer"></div>
  </div>
`,dt=r=>g`
  <div class="teaser-list-horizontal">
    ${ct(r)}
  </div>
`,ht=()=>g`
  <div class="co-container-container">
    <div class="co-container co-taboola-wb" data-service-param-tagid="rectangle_layer" data-taboola-wb></div>
  </div>
`;var fe=class{},me=class{constructor(){this.name_="welcomeback";this.dataURL_="";this.shutdown=!1;this.welcomeBackTimeOut=window.ui.wb&&window.ui.wb.timeout>=0?window.ui.wb.timeout:void 0;this.hasTaboolaConsent=!1}logError(e){d.logUnknownError(e,this.name_),c.publish("sentry:log",{error:e,module:this.name_})}start(){try{if(this.welcomeBackTimeOut===void 0||f.isMobile()){d.log(this.name_,"No ui.wb.timeout object in body. Module init cancelled.");return}c.subscribe("welcomeback:restartWBTimer",()=>{d.log(this.name_,"welcomeback:restartWBTimer"),this.shutdown=!1,this.restartWBTimer()}),c.subscribe("welcomeback:stopWBTimer",e=>{this.shutdown=e!==void 0,this.welcomeBackTimer_&&clearTimeout(this.welcomeBackTimer_)}),c.subscribe("windowScrolling",()=>{this.restartWBTimer()}),c.subscribe("visibilityStateChanged",e=>{this.handleVisibilityStateChange(e)}),E.addEventListener(e=>{this.hasTaboolaConsent=this.checkTaboolaConsent(e.purpose.consents,[1,2,3,4,11])&&e.vendor.consents[42]})}catch(e){this.logError(e)}}checkTaboolaConsent(e,t){return t.reduce((i,n)=>i&&e[n],!0)}showAd(e){if(!f.isDesktop())return;let t=e.getElementsByClassName("co-container")[0];t&&c.publish("dynamicAdsNeeded",[t])}handleJsonData(){d.log(this.name_,"handleJsonData()"),U.getJSON(this.dataURL_).then(e=>{this.openWelcomeBack(e)}).catch(e=>this.logError(e))}openWelcomeBack(e){d.log(this.name_,"openWelcomeBack()");try{let t=T.fromHtml(""),i=!this.adblockerDetected()&&window.ui.wb?.taboola&&this.hasTaboolaConsent;S(je(e.mandant,e.recommended,i),t);let n=document.createElement("div");n.style.display="none",n.appendChild(t),c.publish("overlay:showWelcomeback",{content:n.innerHTML,module:"welcomelayer",opts:{wbTrackingVar:e.clickSuffix},callback:o=>{this.moduleNode=o.querySelector('[data-mod-name="welcomeback"]'),this.moduleNode&&(this.handleWBEvents(this.moduleNode),this.showAd(this.moduleNode))}})}catch(t){this.logError(t)}}setWBCookie(e){let t=new fe;try{switch(e){case"hideForever":t.hide=!0;break;case"pageInactive":t.timestamp=Date.now();break;default:break}Object.keys(t).length>0&&localStorage.setItem(e,JSON.stringify(t))}catch(i){this.logError(i)}}handleCookieData(e){let t=!1;d.log(this.name_,"handleCookieData "+e);try{t=this.parseLocalStorage(e)}catch(i){this.logError(i)}return t}parseLocalStorage(e){let t=!1;try{let i=localStorage.getItem(e);if(i){let n=JSON.parse(i);n&&(d.log(this.name_,"SESSIONSTORAGE AVAILABLE: "+e),d.log(this.name_,i),e==="hideForever"?t=n.hide:e==="pageInactive"&&this.compareTime(n.timestamp,this.welcomeBackTimeOut??0)&&(t=!0))}}catch(i){this.logError(i)}return t}handleWBEvents(e){try{c.publish("mod:dynInit",e),c.publish("welcomeback:brainzone",e);let t=e.getElementsByClassName("js-shownomore")[0];t&&t.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.setWBCookie("hideForever"),c.publish("overlay:close",{moduleName:"welcomelayer",optTrackingName:"_close_remembered"});let o=n.currentTarget,s=o.innerText??o.getAttribute("aria-label")??"",a=o.tagName.toLowerCase();u.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.dialogcontent.welcomeback",componentResultState:"close_remembered",componentLabel:s,elementTagName:a,eventType:"mousedown"})});let i=e.getElementsByClassName("js-backbutton")[0];i&&i.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),c.publish("overlay:close",{moduleName:"welcomelayer"});let o=n.currentTarget,s=o.innerText??o.getAttribute("aria-label")??"",a=o.tagName.toLowerCase();u.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.dialogcontent.welcomeback",componentResultState:"close_back",componentLabel:s,elementTagName:a,eventType:"mousedown"})})}catch(t){this.logError(t)}}handleVisibilityStateChange(e){if(e.target.hidden)this.dataURL_=window.ui.wb?.dataUrl??"",this.setWBCookie("pageInactive");else if(document.querySelector('[data-mod-name="welcomeback"]')!==null){let i=this.handleCookieData("hideForever"),n=this.handleCookieData("pageInactive");!i&&n&&this.handleJsonData()}}compareTime(e,t){let i=!1;try{Date.now()-e>=t&&(i=!0)}catch(n){this.logError(n)}return i}restartWBTimer(){try{this.welcomeBackTimer_!==void 0&&clearTimeout(this.welcomeBackTimer_),this.shutdown||(this.welcomeBackTimer_=setTimeout(()=>{this.dataURL_=window.ui.wb?.dataUrl??"",document.querySelector('[data-mod-name="welcomeback"]')===null&&!this.handleCookieData("hideForever")&&this.handleJsonData()},this.welcomeBackTimeOut))}catch(e){this.logError(e)}}adblockerDetected(){return window.AdService?.info.abd().isBlocked}},ze=new me;var j=class{constructor(){this.inited=!1;this.videoSlideshowInitialized=!1}init(){try{if(this.inited)return;console.log("[video-slideshow-loader] init"),c.subscribeOnce("vertical-video:teaser-clicked",e=>{if(this.videoSlideshowInitialized)return;this.teaserData=e,console.log("[video-slideshow-loader] initializing video slideshow module...");let t=document.querySelector('[data-mod-name="video-slideshow"]');t?.removeAttribute("data-mod-bypass"),t?.setAttribute("data-mod-instant",""),c.publish("mod:dynInit",t?.parentElement)}),c.subscribeOnce("video-slideshow:initialized",()=>{this.videoSlideshowInitialized=!0,this.teaserData&&c.publish("vertical-video:teaser-clicked",this.teaserData)}),this.inited=!0}catch(e){c.publish("sentry:log",{error:e,module:"video-slideshow-loader"})}}};var ge=class{constructor(){this.loader_=be,this.logger_=d,this.pubsub_=c,this.perf_=window.performance||{mark:()=>{}},this.sentryErrors_=[],this.adDeviceClass_=null}start(){try{let e=ve;if(typeof e!="function"){console.warn("No auto-initializer set!");return}let t=this.pubsub_.subscribe("sentry:log",s=>{this.sentryErrors_.push(s)});p.get("logging")||this.logger_.mute(),p.get("adServiceEnabled")||(window.ui.adServiceEnabled=window.ui.AdServiceConfig&&window.ui.AdServiceConfig.enabled===!0);let i={css:b.css,js:b.jsAsset,modules:b.modules};E.init(),window.ui&&window.ui.sentry&&ne.getService("ts/services/sentry.js").then(s=>{t.remove(),s.init(this.sentryErrors_)}),window.requestIdleCallback(()=>{ze.start()},{timeout:3e3}),Se.init(),Ce.init(),Ee.init(),ye.init(),this.pubsub_.subscribe("mod:init",s=>{this.logger_.log("app",`Module "${s.moduleName}" initialized.`)}),this.pubsub_.subscribe("mod:dynInit",s=>{e(s,void 0,this.loader_,i)}),this.pubsub_.subscribe("webcomponent:dynInit",s=>{se(s,b.modules)}),window.addEventListener("resize",()=>{this.pubsub_.publish("window:resize")}),window.addEventListener("load",()=>{this.pubsub_.publish("windowLoaded"),console.log("windowLoaded")}),document.addEventListener("visibilitychange",s=>{this.pubsub_.publish("visibilityStateChanged",s),this.logger_.log("app","visibilityState (hidden) changed to: "+s.target.hidden)}),this.pubsub_.subscribe("asLoader:AdServiceLoaded",s=>{let{useDefaultConfig:a}=s;window.ui&&window.ui.adServiceEnabled&&ne.getService("js/services/ads.js").then(l=>{l.initialize(a),this.perf_.mark("adservice-init-end")})}),this.pubsub_.subscribeOnce("ad:gotDeviceClass",s=>{this.adDeviceClass_=s}),window.addEventListener("message",s=>{if(s.data.method==="scrollup"){let a="iFrameResizer0";s.data.offSet||(s.data.offSet=100),s.data.id&&(a=s.data.id),f.scrollViewPortTo(document.getElementById(a),s.data.offSet)}},!1),window.addEventListener("message",s=>{if(s.origin==="https://player.glomex.com"){console.log("glomex events",s);let a=s.data.__tcfapiCall,l=Array.from(document.querySelectorAll("iframe.video__content")).filter(h=>h.src.indexOf("glomex")>-1);a&&(a.command==="getTCData"||a.command==="addEventListener")&&(console.log("glomex data",a),l.forEach(h=>{E.getTCData((m,B)=>{console.log("glomex","sending"),h.contentWindow.postMessage({__tcfapiReturn:{returnValue:m,success:B,callId:a.callId}},"*")})}))}s.data.externalEmbed&&this.pubsub_.publish("externalembed:loaded",s.data.externalEmbed)},!1),this.loadAdService();try{Q.init(void 0,E.getPermission("brainTracking"))}catch{Q.init(void 0)}qe.run(),this.pubsub_.publish("ad:gotDeviceClass",this.adDeviceClass_),e(void 0,void 0,this.loader_,i,!0),se(document,b.modules),new j().init(),(s=>{let a;window.addEventListener("scroll",()=>{a&&window.clearTimeout(a),a=setTimeout(()=>{this.pubsub_.publish("windowScrolling")},s)})})(50),window.potec||(window.potec={}),typeof window.potec.handleAdRefresh>"u"&&(window.potec.handleAdRefresh=function(s){try{if(s){let a={trigger:"",method:"adRefresh",top:C.hasProperty(s,"top")&&s.top===!0,sky:C.hasProperty(s,"sky")&&s.sky===!0,rect:C.hasProperty(s,"rect")&&s.rect===!0};window.postMessage(a,"*")}}catch(a){console.log(a),this.pubsub_.publish("sentry:log",{error:a})}})}catch(e){console.log(e),this.pubsub_.publish("sentry:log",{error:e})}}loadAdService(){if(p.get("adServiceEnabled")){let e=window.ui.AdServiceConfig.biddingConfigUrls,t=f.getLayoutClassForCurrentViewPortWidth();D.adServiceConfig=window.ui.AdServiceConfig,D.adBiddingConfigFileUrl=e[t],D.run()}else D.sendFallbackTrackingInfo()}},$e=new ge;window.requestIdleCallback=window.requestIdleCallback??function(r){return setTimeout(function(){let e=Date.now();r({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback??function(r){clearTimeout(r)};window.yieldToMain=()=>new Promise(r=>{setTimeout(r,0)});requestAnimationFrame(()=>{document.documentElement.classList.remove("no-js")});var pe=[];window.ui.tcfUrl&&pe.push(window.ui.tcfUrl);window.ui.AdServiceConfig&&window.ui.AdServiceConfig.enabled===!0&&pe.push(b.sn+"/vendor/adservice2-defaultConfig.js");var Je=document.readyState,Ge=()=>{P.fetchAll(pe).catch(r=>{console.error("Error loading scripts!",r)}).finally(()=>{$e.start()})};Je==="interactive"||Je==="complete"?Ge():document.addEventListener("DOMContentLoaded",Ge);
//# sourceMappingURL=entry.js.map
